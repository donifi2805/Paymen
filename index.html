[
  {
    "snippet": "    function renderHistoryList() {\n        // --- FILTERING ---\n        let filtered = transactions;\n        if (currentFilter === 'today') {\n            const today = new Date().toISOString().split('T')[0];\n            filtered = transactions.filter(t => t.date.startsWith(today));\n        } else if (currentFilter === 'week') {\n            // Simple week logic (last 7 days)\n            const d = new Date(); d.setDate(d.getDate() - 7);\n            const weekAgo = d.toISOString().split('T')[0];\n            filtered = transactions.filter(t => t.date >= weekAgo);\n        }\n\n        // --- RENDER FULL HISTORY (PAGE) ---\n        let html = '';\n        if(filtered.length === 0) html = '<div class=\"text-center text-gray-400 text-xs py-10\">Belum ada transaksi</div>';\n        else {\n            filtered.forEach(t => {\n                const isOut = t.type === 'out';\n                \n                // Logic Warna Status\n                let statusClass = 'text-orange-500 bg-orange-50 border-orange-100';\n                let statusIcon = '<i class=\"fas fa-clock\"></i>';\n                if(t.status === 'Sukses') { \n                    statusClass = 'text-green-600 bg-green-50 border-green-100'; \n                    statusIcon = '<i class=\"fas fa-check-circle\"></i>';\n                } else if(t.status === 'Gagal' || String(t.status).includes('Batal')) { \n                    statusClass = 'text-red-500 bg-red-50 border-red-100'; \n                    statusIcon = '<i class=\"fas fa-times-circle\"></i>';\n                }\n\n                // Pesan SN (Jika ada)\n                let snDisplay = t.api_msg || '';\n                if(snDisplay.length > 50) snDisplay = snDisplay.substring(0, 50) + '...';\n\n                html += `<div onclick=\"openTrxDetail('${t.trx_id}')\" class=\"cursor-pointer active:scale-[0.98] transition-transform bg-white dark:bg-gray-900 p-3 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm mb-3\">\n                    <div class=\"flex justify-between items-start mb-2\">\n                        <div class=\"flex items-center gap-3\">\n                            <div class=\"w-10 h-10 rounded-full flex items-center justify-center ${isOut?'bg-blue-100 text-blue-600':'bg-green-100 text-green-600'}\">\n                                <i class=\"fas ${isOut?'fa-arrow-up':'fa-arrow-down'}\"></i>\n                            </div>\n                            <div>\n                                <p class=\"font-bold text-sm text-gray-800 dark:text-white\">${t.title}</p>\n                                <p class=\"text-[10px] text-gray-400\">${new Date(t.date).toLocaleString('id-ID')}</p>\n                            </div>\n                        </div>\n                        <div class=\"text-right\">\n                            <p class=\"text-sm font-bold ${isOut?'text-gray-800 dark:text-white':'text-green-600'}\">${isOut?'-':'+'} ${window.formatRp(t.amount)}</p>\n                            <span class=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[9px] font-bold border ${statusClass}\">\n                                ${statusIcon} ${t.status}\n                            </span>\n                        </div>\n                    </div>\n                    ${snDisplay ? `<div class=\"mt-1 pt-2 border-t border-dashed border-gray-100 dark:border-gray-700\"><p class=\"text-[10px] text-gray-500 font-mono break-all\"><i class=\"fas fa-info-circle text-blue-400 mr-1\"></i>${snDisplay}</p></div>` : ''}\n                </div>`;\n            });\n        }\n        document.getElementById('fullHistory').innerHTML = html;\n\n        // --- RENDER MINI HISTORY (HOME) ---\n        if(document.getElementById('miniHistory')) {\n            let miniHtml = '';\n            if(filtered.length === 0) miniHtml = '<div class=\"text-center text-gray-400 text-[10px] py-4\">Belum ada transaksi</div>';\n            else {\n                filtered.slice(0, 3).forEach(t => {\n                    const isOut = t.type === 'out';\n                    let statusColor = 'text-orange-500';\n                    if(t.status === 'Sukses') statusColor = 'text-green-600';\n                    else if(t.status === 'Gagal' || String(t.status).includes('Batal')) statusColor = 'text-red-500';\n\n                    miniHtml += `<div onclick=\"openTrxDetail('${t.trx_id}')\" class=\"cursor-pointer active:scale-[0.98] transition-transform flex justify-between items-center border-b border-gray-50 dark:border-gray-800 pb-3 last:border-0 last:pb-0\">\n                        <div class=\"flex items-center gap-3\">\n                            <div class=\"w-9 h-9 rounded-full flex items-center justify-center ${isOut?'bg-blue-50 text-blue-600':'bg-green-50 text-green-600'}\">\n                                <i class=\"fas ${isOut?'fa-arrow-up':'fa-arrow-down'} text-xs\"></i>\n                            </div>\n                            <div class=\"flex-1 min-w-0\">\n                                <p class=\"font-bold text-xs text-gray-800 dark:text-white line-clamp-1\">${t.title}</p>\n                                <div class=\"flex items-center gap-2\">\n                                     <p class=\"text-[9px] text-gray-400\">${t.date.split('T')[0]}</p>\n                                     <span class=\"text-[8px] font-bold px-1.5 py-0.5 rounded border border-gray-100 dark:border-gray-700 ${statusColor}\">${t.status}</span>\n                                </div>\n                            </div>\n                        </div>\n                        <p class=\"text-xs font-bold ${isOut?'text-gray-800 dark:text-white':'text-green-600'}\">${isOut?'-':'+'} ${window.formatRp(t.amount)}</p>\n                    </div>`;\n                });\n            }\n            document.getElementById('miniHistory').innerHTML = miniHtml;\n        }\n        \n        if(window.renderTopUpHistory) window.renderTopUpHistory();\n        if(window.checkPendingTrx) window.checkPendingTrx();\n    }",
    "target": "function renderHistoryList() {[\\s\\S]*?if\\(window.checkPendingTrx\\) window.checkPendingTrx\\(\\);\\s*}",
    "action": "replace",
    "regex": true,
    "global": false
  }
]